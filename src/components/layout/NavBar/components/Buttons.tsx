"use client"

import { useRouter } from "next/navigation"

import Button from "@/components/common/Button"
import IconPlus from "@/components/icons/IconPlus"

import { cx } from "@/lib/cx"
import { useSign } from "../../FooterMenu/hooks/useSign"
import { useStatusAuth } from "@/helpers/use-status-auth"
import { dispatchDownloadApplication, dispatchNewServicesBanner, EModalData, EStatusAuth, useModal } from "@/store"

import styles from "../styles/button-download-app.module.scss"

export const Buttons = () => {
  const { push } = useRouter()
  const handleAuthModal = useSign()
  const statusAuth = useStatusAuth()
  const isCreateModal = useModal(({ data }) => data === EModalData.NewServicesBanner)

  return (
    <div className="relative flex flex-row gap-3">
      <Button
        type="button"
        label="Скачать приложение"
        typeButton="regular-primary"
        className="px-4 w-min"
        prefixIcon={<IconDownloadApp />}
        onClick={() => dispatchDownloadApplication(true)}
      />
      <Button
        type="button"
        label="Профиль"
        typeButton="regular-primary"
        className="min-w-[8.875rem]"
        onClick={() => {
          if (statusAuth === EStatusAuth.AUTHORIZED) {
            push("/profile")
          } else {
            handleAuthModal()
          }
        }}
      />
      <Button
        label="Создать"
        typeButton="fill-primary"
        className="min-w-[8.875rem]"
        suffixIcon={
          <div
            className={cx(
              "relative w-6 h-6 *:w-6 :h-6 [&>svg>path]:fill-text-button *:transition-transform *:duration-200",
              isCreateModal ? "*:rotate-180" : "*:rotate-0",
            )}
          >
            <IconPlus />
          </div>
        }
        style={{ width: "100%" }}
        onClick={statusAuth !== EStatusAuth.AUTHORIZED ? handleAuthModal : dispatchNewServicesBanner}
        data-test="nav-bar-button-create"
        id="nav-bar-button-create"
      />
    </div>
  )
}

const IconDownloadApp = () => (
  <div
    className={cx(
      styles.button,
      "w-6 h-6 rounded-md relative overflow-hidden",
      "*:absolute *:top-1/2 *:left-1/2 *:-translate-x-1/2 *:-translate-y-1/2 *:w-[1.1rem] *:h-[1.11669rem] *:z-10",
    )}
  >
    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="19" viewBox="0 0 18 19" fill="none">
      <path
        d="M16.2104 1.97013C15.7938 1.53563 15.2991 1.19096 14.7547 0.955803C14.2103 0.720646 13.6267 0.599609 13.0374 0.599609C12.4481 0.599609 11.8646 0.720646 11.3202 0.955803C10.7757 1.19096 10.2811 1.53563 9.86449 1.97013L8.99988 2.87143L8.13527 1.97013C7.29375 1.09289 6.15241 0.600064 4.96232 0.600064C3.77224 0.600064 2.63089 1.09289 1.78938 1.97013C0.947858 2.84736 0.475098 4.03715 0.475098 5.27775C0.475098 6.51834 0.947858 7.70813 1.78938 8.58537L8.39231 15.4686C8.72665 15.8171 9.27311 15.8171 9.60744 15.4686L16.2104 8.58537C16.6272 8.15108 16.9578 7.63544 17.1834 7.0679C17.409 6.50037 17.5251 5.89207 17.5251 5.27775C17.5251 4.66342 17.409 4.05512 17.1834 3.48759C16.9578 2.92006 16.6272 2.40442 16.2104 1.97013Z"
        fill="white"
      />
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.20068 8.65653V9.10156L7.20021 9.10909C7.19128 9.25074 7.22263 9.39201 7.2908 9.51763C7.35896 9.64325 7.4613 9.74839 7.58667 9.82183L7.58811 9.82267L7.58953 9.82352C7.8772 9.99696 8.3356 10.1002 8.99982 10.1002C9.63319 10.1002 10.083 10.0056 10.3772 9.84357L10.3858 9.83886L10.3947 9.83479C10.508 9.78295 10.6036 9.70071 10.6701 9.59772C10.7365 9.49472 10.7708 9.37536 10.769 9.2539L10.7688 9.24701L10.7691 9.24013C10.7738 9.12882 10.7445 9.01871 10.685 8.92346C10.6254 8.82822 10.5384 8.75208 10.4346 8.70434L10.4301 8.70225L10.4256 8.69999C10.1468 8.55864 9.56023 8.41421 8.62353 8.28032L8.62303 8.28024C7.61842 8.13471 6.87042 7.91496 6.4338 7.59153C6.22421 7.44692 6.05369 7.25599 5.93649 7.03481C5.81866 6.81242 5.75818 6.56599 5.76011 6.31636C5.76046 5.69725 6.08599 5.20455 6.67776 4.84706C7.26491 4.49237 8.03802 4.32981 8.97303 4.33407C9.91694 4.33414 10.6992 4.5131 11.2954 4.89622C11.894 5.28088 12.2202 5.79656 12.2212 6.43409L12.2212 6.43447V6.74799H10.5575V6.34487L10.5575 6.34216C10.5606 6.20782 10.529 6.07488 10.4657 5.95529C10.4024 5.83572 10.3094 5.73327 10.1951 5.65705L10.1916 5.65471L10.1882 5.65226C9.93626 5.47218 9.52741 5.36099 8.92005 5.35777C8.3051 5.3545 7.89158 5.44252 7.64201 5.58751L7.63368 5.59235L7.62499 5.59658C7.52615 5.64467 7.44331 5.71886 7.38617 5.81067C7.32902 5.9025 7.29996 6.00815 7.30243 6.11539L7.30261 6.12296L7.3023 6.13052C7.2982 6.23286 7.3242 6.33417 7.37723 6.42272C7.43025 6.51127 7.50807 6.5834 7.60158 6.63088L7.60586 6.63305L7.61004 6.63537C7.72161 6.69724 7.92252 6.76695 8.23323 6.83755C8.53873 6.90698 8.93213 6.97338 9.41574 7.03616L9.4171 7.03634C10.3659 7.16443 11.0973 7.37768 11.5764 7.69823C11.8118 7.8445 12.0048 8.04604 12.1372 8.28386C12.2701 8.52256 12.3377 8.78994 12.3335 9.06073C12.3329 9.70268 12.0136 10.2168 11.4197 10.5897C10.8275 10.9614 9.97893 11.1314 8.9104 11.134L8.90975 11.134C7.85522 11.134 7.01705 10.9612 6.43393 10.5789C6.15117 10.4051 5.91983 10.1638 5.76225 9.8785C5.60453 9.59298 5.52604 9.27309 5.53428 8.94983V8.66019L7.20068 8.65653Z"
        fill="white"
      />
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.20068 8.65653V9.10156L7.20021 9.10909C7.19128 9.25074 7.22263 9.39201 7.2908 9.51763C7.35896 9.64325 7.4613 9.74839 7.58667 9.82183L7.58811 9.82267L7.58953 9.82352C7.8772 9.99696 8.3356 10.1002 8.99982 10.1002C9.63319 10.1002 10.083 10.0056 10.3772 9.84357L10.3858 9.83886L10.3947 9.83479C10.508 9.78295 10.6036 9.70071 10.6701 9.59772C10.7365 9.49472 10.7708 9.37536 10.769 9.2539L10.7688 9.24701L10.7691 9.24013C10.7738 9.12882 10.7445 9.01871 10.685 8.92346C10.6254 8.82822 10.5384 8.75208 10.4346 8.70434L10.4301 8.70225L10.4256 8.69999C10.1468 8.55864 9.56023 8.41421 8.62353 8.28032L8.62303 8.28024C7.61842 8.13471 6.87042 7.91496 6.4338 7.59153C6.22421 7.44692 6.05369 7.25599 5.93649 7.03481C5.81866 6.81242 5.75818 6.56599 5.76011 6.31636C5.76046 5.69725 6.08599 5.20455 6.67776 4.84706C7.26491 4.49237 8.03802 4.32981 8.97303 4.33407C9.91694 4.33414 10.6992 4.5131 11.2954 4.89622C11.894 5.28088 12.2202 5.79656 12.2212 6.43409L12.2212 6.43447V6.74799H10.5575V6.34487L10.5575 6.34216C10.5606 6.20782 10.529 6.07488 10.4657 5.95529C10.4024 5.83572 10.3094 5.73327 10.1951 5.65705L10.1916 5.65471L10.1882 5.65226C9.93626 5.47218 9.52741 5.36099 8.92005 5.35777C8.3051 5.3545 7.89158 5.44252 7.64201 5.58751L7.63368 5.59235L7.62499 5.59658C7.52615 5.64467 7.44331 5.71886 7.38617 5.81067C7.32902 5.9025 7.29996 6.00815 7.30243 6.11539L7.30261 6.12296L7.3023 6.13052C7.2982 6.23286 7.3242 6.33417 7.37723 6.42272C7.43025 6.51127 7.50807 6.5834 7.60158 6.63088L7.60586 6.63305L7.61004 6.63537C7.72161 6.69724 7.92252 6.76695 8.23323 6.83755C8.53873 6.90698 8.93213 6.97338 9.41574 7.03616L9.4171 7.03634C10.3659 7.16443 11.0973 7.37768 11.5764 7.69823C11.8118 7.8445 12.0048 8.04604 12.1372 8.28386C12.2701 8.52256 12.3377 8.78994 12.3335 9.06073C12.3329 9.70268 12.0136 10.2168 11.4197 10.5897C10.8275 10.9614 9.97893 11.1314 8.9104 11.134L8.90975 11.134C7.85522 11.134 7.01705 10.9612 6.43393 10.5789C6.15117 10.4051 5.91983 10.1638 5.76225 9.8785C5.60453 9.59298 5.52604 9.27309 5.53428 8.94983V8.66019L7.20068 8.65653Z"
        fill="url(#paint0_linear_7780_15925)"
      />
      <ellipse cx="9.00023" cy="17.3742" rx="1.09349" ry="1.09388" fill="white" />
      <defs>
        <linearGradient id="paint0_linear_7780_15925" x1="5.95869" y1="4.92898" x2="11.0587" y2="9.85898" gradientUnits="userSpaceOnUse">
          <stop stop-color="#DA42E1" />
          <stop offset="1" stop-color="#474AE2" />
        </linearGradient>
      </defs>
    </svg>
  </div>
)
